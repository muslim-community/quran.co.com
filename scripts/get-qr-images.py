import requests
import urllib.request
import time


site_list = ['https://images.qurancomplex.gov.sa/publications/telugu/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_amazigi/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_azerbaijani/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_basaa/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_farsi/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_hindi/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_kurdish/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_kyrgyz/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_lingala_juzu_amma/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_malaghshiah_juzu_amma/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_russian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_sindiya/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_swedish/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/trans_ukranian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/turkish/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/urdu/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/vietnami/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/01_big/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/02_jawamee/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/04_standard1/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/05_standard2/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/07_wasat/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/31_warsh/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/a_70_nastaleeq/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/anko/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_01/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_02/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_03/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_04/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_05/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_06/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_07/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_08/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_09/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_10/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_11/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_12/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_13/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_14/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_15/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_16/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_17/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_18/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_19/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_20/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_21/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_22/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_23/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_24/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_25/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_26/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_27/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_28/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_29/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_30/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_31/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_32/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_33/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_34/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_35/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_36/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_fatawa_37/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_misbah_muneer_chinese/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_osoul_eman_chinese/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_osoul_eman_english/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_osoul_eman_russian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_osoul_eman_ukrainian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_thikr_wa_duaa_english/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/bk_thikr_wa_duaa_urdu/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/chinese/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/douri/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/english_only/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/fiqh_muyassar/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/french_hafs/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/hausa/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/hungarian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/indonesian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/iranouniya/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/italian/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/kitabat_almushaf/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/malibari/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/portuguese/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/q_30_shubah/650/jpg_90/', 'https://images.qurancomplex.gov.sa/publications/tafseer_muyassar/650/jpg_90/']

dir_list = ['E:/qr/qr-images/images.qurancomplex.gov.sa/publications/telugu/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_amazigi/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_azerbaijani/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_basaa/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_farsi/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_hindi/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_kurdish/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_kyrgyz/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_lingala_juzu_amma/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_malaghshiah_juzu_amma/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_russian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_sindiya/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_swedish/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/trans_ukranian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/turkish/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/urdu/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/vietnami/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/01_big/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/02_jawamee/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/04_standard1/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/05_standard2/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/07_wasat/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/31_warsh/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/a_70_nastaleeq/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/anko/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_01/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_02/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_03/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_04/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_05/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_06/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_07/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_08/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_09/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_10/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_11/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_12/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_13/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_14/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_15/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_16/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_17/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_18/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_19/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_20/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_21/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_22/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_23/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_24/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_25/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_26/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_27/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_28/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_29/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_30/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_31/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_32/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_33/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_34/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_35/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_36/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_fatawa_37/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_misbah_muneer_chinese/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_osoul_eman_chinese/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_osoul_eman_english/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_osoul_eman_russian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_osoul_eman_ukrainian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_thikr_wa_duaa_english/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/bk_thikr_wa_duaa_urdu/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/chinese/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/douri/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/english_only/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/fiqh_muyassar/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/french_hafs/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/hausa/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/hungarian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/indonesian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/iranouniya/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/italian/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/kitabat_almushaf/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/malibari/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/portuguese/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/q_30_shubah/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tafseer_muyassar/650/jpg_90/']

def is_url_valid(url):    
    retry_count = 0
    # loop for retries
    while True:
        try:
            # get with timeout and convert http errors to exceptions
            #resp = requests.get(url[0], timeout=10)
            #resp.raise_for_status()
            r = requests.head(url)
            r.raise_for_status()
            if r.status_code == 200:
              return True
            else:
              return False
        # the things you want to recover from
        except requests.Timeout as e:
            if retry_count < 5:
                print("timeout, wait and retry:", e)
                time.sleep(15)
                retry_count += 1
                continue
            else:
                print("timeout, exiting")
                raise # reraise exception to exit
        except requests.exceptions.HTTPError as e:
            print(url + " 404 >> next site")
            return False
        except Exception as e:
            print("unrecoverable error", e)
            raise
        break

def download_image(url, path):    
    urllib.request.urlretrieve(url, path)

site_list_temp = ['https://images.qurancomplex.gov.sa/publications/tafseer_muyassar/650/jpg_90/','https://images.qurancomplex.gov.sa/publications/telugu/650/jpg_90/']

dir_list_temp = ['E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tafseer_muyassar/650/jpg_90/','E:/qr/qr-images/images.qurancomplex.gov.sa/publications/telugu/650/jpg_90/']

done_site_list = ['https://images.qurancomplex.gov.sa/publications/telugu/650/', 'https://images.qurancomplex.gov.sa/publications/trans_amazigi/650/', 'https://images.qurancomplex.gov.sa/publications/trans_azerbaijani/650/', 'https://images.qurancomplex.gov.sa/publications/trans_basaa/650/', 'https://images.qurancomplex.gov.sa/publications/trans_farsi/650/', 'https://images.qurancomplex.gov.sa/publications/trans_hindi/650/', 'https://images.qurancomplex.gov.sa/publications/trans_kurdish/650/', 'https://images.qurancomplex.gov.sa/publications/trans_kyrgyz/650/', 'https://images.qurancomplex.gov.sa/publications/trans_lingala_juzu_amma/650/', 'https://images.qurancomplex.gov.sa/publications/trans_malaghshiah_juzu_amma/650/', 'https://images.qurancomplex.gov.sa/publications/trans_russian/650/', 'https://images.qurancomplex.gov.sa/publications/trans_sindiya/650/', 'https://images.qurancomplex.gov.sa/publications/trans_swedish/650/', 'https://images.qurancomplex.gov.sa/publications/trans_ukranian/650/', 'https://images.qurancomplex.gov.sa/publications/turkish/650/']

to_do_dir_list = ['E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tamil/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/hausa/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/hungarian/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/indonesian/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/iranouniya/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/italian/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/kitabat_almushaf/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/malibari/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/portuguese/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/q_30_shubah/650/jpg_90/', 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tafseer_muyassar/650/jpg_90/']

for index, site in enumerate(site_list):
  if dir_list[index] in to_do_dir_list:
    i = 1
    url = site + str(i).zfill(4) + '.jpg'
    path = dir_list[index] + str(i).zfill(4) + '.jpg'
    # url = 'https://images.qurancomplex.gov.sa/publications/tamil/650/jpg_90/' + str(i).zfill(4) + '.jpg'
    # path = 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tamil/650/jpg_90/' + str(i).zfill(4) + '.jpg'
    while is_url_valid(url):
      download_image(url, path)
      i += 1
      url = site + str(i).zfill(4) + '.jpg'
      path = dir_list[index] + str(i).zfill(4) + '.jpg'
      # url = 'https://images.qurancomplex.gov.sa/publications/tamil/650/jpg_90/' + str(i).zfill(4) + '.jpg'
      # path = 'E:/qr/qr-images/images.qurancomplex.gov.sa/publications/tamil/650/jpg_90/' + str(i).zfill(4) + '.jpg'